<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.0.0-beta.3 for Hugo"><meta name=description content="Transformer model empowered architectures have become a pillar of cloud services that keeps reshaping our society. However, the dynamic query loads and heterogeneous user requirements severely challenge current transformer serving systems, which rely on pre-training multiple variants of a foundation model to accommodate varying service demands."><link rel=alternate hreflang=en-us href=https://peilab.netlify.app/project/an-elastic-transformer-serving-system-for-foundation-model-via-token-adaptation-%E5%89%AF%E6%9C%AC/><link rel=preconnect href=https://fonts.gstatic.com crossorigin><meta name=theme-color content="#1565c0"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin=anonymous media=print onload="this.media='all'"><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload="this.media='all'"><link rel=stylesheet href=/css/wowchemy.14ed061da97974d1963d99308520201c.css><link rel=manifest href=/index.webmanifest><link rel=icon type=image/png href=/media/icon_hu120395325dac92a7b24d7fd791d5bf28_509340_32x32_fill_lanczos_center_2.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu120395325dac92a7b24d7fd791d5bf28_509340_180x180_fill_lanczos_center_2.png><link rel=canonical href=https://peilab.netlify.app/project/an-elastic-transformer-serving-system-for-foundation-model-via-token-adaptation-%E5%89%AF%E6%9C%AC/><meta property="twitter:card" content="summary_large_image"><meta property="og:site_name" content="PEILab"><meta property="og:url" content="https://peilab.netlify.app/project/an-elastic-transformer-serving-system-for-foundation-model-via-token-adaptation-%E5%89%AF%E6%9C%AC/"><meta property="og:title" content="An Elastic Transformer Serving System for Foundation Model via Token Adaptation | PEILab"><meta property="og:description" content="Transformer model empowered architectures have become a pillar of cloud services that keeps reshaping our society. However, the dynamic query loads and heterogeneous user requirements severely challenge current transformer serving systems, which rely on pre-training multiple variants of a foundation model to accommodate varying service demands."><meta property="og:image" content="https://peilab.netlify.app/project/an-elastic-transformer-serving-system-for-foundation-model-via-token-adaptation-%E5%89%AF%E6%9C%AC/featured.png"><meta property="twitter:image" content="https://peilab.netlify.app/project/an-elastic-transformer-serving-system-for-foundation-model-via-token-adaptation-%E5%89%AF%E6%9C%AC/featured.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2023-09-01T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-01T00:00:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://peilab.netlify.app/project/an-elastic-transformer-serving-system-for-foundation-model-via-token-adaptation-%E5%89%AF%E6%9C%AC/"},"headline":"An Elastic Transformer Serving System for Foundation Model via Token Adaptation","image":["https://peilab.netlify.app/project/an-elastic-transformer-serving-system-for-foundation-model-via-token-adaptation-%E5%89%AF%E6%9C%AC/featured.png"],"datePublished":"2023-09-01T00:00:00Z","dateModified":"2023-09-01T00:00:00Z","author":{"@type":"Person","name":"Authors"},"publisher":{"@type":"Organization","name":"PEILab","logo":{"@type":"ImageObject","url":"https://peilab.netlify.app/media/logo_hude7c550c9b1c4d0119cb1e6619a815ae_62586_192x192_fit_lanczos_2.png"}},"description":"Transformer model empowered architectures have become a pillar of cloud services that keeps reshaping our society. However, the dynamic query loads and heterogeneous user requirements severely challenge current transformer serving systems, which rely on pre-training multiple variants of a foundation model to accommodate varying service demands."}</script><title>An Elastic Transformer Serving System for Foundation Model via Token Adaptation | PEILab</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=3c154a3ff35f8513b51fc2b527d57d4c><script src=/js/wowchemy-init.min.b024895df05e271929739bb54886c674.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class=page-header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/media/logo_hude7c550c9b1c4d0119cb1e6619a815ae_62586_0x70_resize_lanczos_2.png alt=PEILab></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/media/logo_hude7c550c9b1c4d0119cb1e6619a815ae_62586_0x70_resize_lanczos_2.png alt=PEILab></a></div><div class="navbar-collapse main-menu-item collapse justify-content-end" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/research><span>Research</span></a></li><li class=nav-item><a class=nav-link href=/people><span>People</span></a></li><li class=nav-item><a class=nav-link href=/publication><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/demos><span>Demos</span></a></li><li class=nav-item><a class=nav-link href=/post><span>News</span></a></li><li class=nav-item><a class=nav-link href=/workshop><span>Workshop</span></a></li><li class=nav-item><a class=nav-link href=/gallery><span>Gallery</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></div><div class=page-body><article class="article article-project"><div class="article-container pt-3"><h1>An Elastic Transformer Serving System for Foundation Model via Token Adaptation</h1><div class=article-metadata><span class=article-date>Sep 1, 2023</span></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-4" style=max-width:542px;max-height:264px><div style=position:relative><img src=/project/an-elastic-transformer-serving-system-for-foundation-model-via-token-adaptation-%E5%89%AF%E6%9C%AC/featured.png alt class=featured-image></div></div><div class=article-container><div class=article-style><p>Transformer model empowered architectures have become a pillar of cloud services that keeps reshaping our society. However, the dynamic query loads and heterogeneous user requirements severely challenge current transformer serving systems, which rely on pre-training multiple variants of a foundation model to accommodate varying service demands. Unfortunately, such a mechanism is unsuitable for large transformer models due to the prohibitive training costs and excessive I/O delay. We introduce OTAS, the first elastic serving system specially tailored for transformer models by exploring lightweight token management. We develop a novel idea called token adaptation. To cope with fluctuating query loads and diverse user requests, we enhance OTAS with application-aware selective batching and online token adaptation.</p><h2 id=prototype-overview>Prototype Overview</h2><p>We use Python to process the incoming queries and PyTorch to define the neural networks. We build the transformer model with timm library and insert two modules to add and remove the processing tokens at each layer. The system enables users to make a query and register tasks with two interfaces. The Make Query interface processes a query that comprises an image sample and various attributes. The Register Task interface saves the task parameters in the task model list and the corresponding latency and utility values in the task data list.</p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/project/an-elastic-transformer-serving-system-for-foundation-model-via-token-adaptation-%E5%89%AF%E6%9C%AC/1_hu79deb2fad71fbde07430773b3e61f36e_56060_4e1cf762b6d7ec989fbfc50b1c0ced7c.png 400w,
/project/an-elastic-transformer-serving-system-for-foundation-model-via-token-adaptation-%E5%89%AF%E6%9C%AC/1_hu79deb2fad71fbde07430773b3e61f36e_56060_e732651146b62d746651e812971b9fc1.png 760w,
/project/an-elastic-transformer-serving-system-for-foundation-model-via-token-adaptation-%E5%89%AF%E6%9C%AC/1_hu79deb2fad71fbde07430773b3e61f36e_56060_1200x1200_fit_lanczos_2.png 1200w" src=/project/an-elastic-transformer-serving-system-for-foundation-model-via-token-adaptation-%E5%89%AF%E6%9C%AC/1_hu79deb2fad71fbde07430773b3e61f36e_56060_4e1cf762b6d7ec989fbfc50b1c0ced7c.png width=309 height=260 loading=lazy data-zoomable></div></div></figure></div><div class=article-tags><a class="badge badge-light" href=/tags/ai-computing-cyberinfrastructure/>AI Computing Cyberinfrastructure</a></div><div class="project-related-pages content-widget-hr"></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class=powered-by>Copyright © The Pervasive Edge Intelligence Laboratory Reserved. 2023</p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-modules target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i>Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i>Download</a><div id=modal-error></div></div></div></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin=anonymous></script><script id=search-hit-fuse-template type=text/x-template>
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/js/_vendor/bootstrap.bundle.min.6aed84840afc03ab4d5750157f69c120.js></script><script src=/en/js/wowchemy.min.e844b7881168826667ba422c36255a69.js></script><script async defer src=https://buttons.github.io/buttons.js></script></body></html>